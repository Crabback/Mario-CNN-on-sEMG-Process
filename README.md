# Enhanced sEMG Signals Process with Mario CNN on Gesture Classification

Collaborators: Zhengjia Mao, Hao Dong, Yuxin Wang

**Abstract**

sEMG signals show huge potential in implementing control systems of mechatronics devices, and small muscle movements can generate enough sEMG signals to achieve desired control operations. Traditional methods on the sEMG signals process do not robustly decipher important information to distinguish subtle differences in gesture classification. This paper applied a novel deep learning method, a two-stream CNN architecture called Mario CNN, to process NinaPro DB1 data on gesture classification and achieved higher accuracy than a single stream CNN.

**Keywords**: gesture recognition; convolution neural network; surface electromyographic

**Introduction**

Surface Electromyography (sEMG) measures the electrical activity generated by muscle impulses, as shown in Figure 1. The generated potential difference usually ranges from -90mV to 30mV, but the amplitude patch electrodes can only measure about ±5 mV from the skin. sEMG is widely used in implementing control systems of mechatronics devices, and more specifically, small muscle movements can generate enough signals to achieve desired control operations. According to the literature, sEMG is often mixed with very low frequency (near DC) and high-frequency interference signals, while the effective sEMG signal spectrum is distributed between 10-500Hz[1]. Therefore, the signal detected from the patch electrode needs to go through a signal conditioning process such as high-pass filtering (straightening process), high-pass amplification, and low-pass filtering.

![This is an image](https://github.com/Crabback/Mario-CNN-on-sEMG-Recognition/blob/main/figure1.PNG)

Figure 1: sEMG signals example for three gestures (one for each column)[2]

While sEMG signals show huge potentials, the applications are relatively immature. Current problems include monotonous signal sources, ambiguous classification, and noise under non-ideal conditions. The measurements can be easily affected by many factors like electrode shifts, limb position, muscle fatigue. Meanwhile, inconsistent labels may have similar signals but with different amplitudes, and traditional machine learning classification methods do not robustly decipher important information. Therefore, researchers and scientists in recent years (especially since 2014) began to apply deep learning methods to process sEMG signals on applications, including hand gesture recognition, speech and emotion classification, and sleep stage classification. This paper studied the networks from related papers and applied a novel "Mario Brothers" neural network (Mario CNN) to process sEMG signals on gesture recognition. The name is inspired by Mario and Luigi, who run towards the same goal in a parallel manner, as shown in Figure 2.

![This is an image](https://github.com/Crabback/Mario-CNN-on-sEMG-Recognition/blob/main/figure2.PNG)

Figure 2: Mario and Luigi run in a parallel manner

**Related Works**

Five main deep learning architectures are commonly used in sEMG signal recognition: deep feedforward neural networks (DNN), recurrent neural networks (RNN), convolutional neural networks (CNN), autoencoders (AEs), and deep belief networks (DBN)[3]. Some of the related papers we read are summarized below.


_“Deep Learning with Convolutional Neural Networks Applied to Electromyography Data: A Resource for the Classification of Movements for Prosthetic Hands ”[4]_

This paper implemented a modified version of a CNN (LeNet; LeCun et al., 1995) on the NinaPro dataset and achieved an accuracy of 66.59±6.40% on dataset 1. The input data was obtained with 150 ms time-windows. The architecture consisted of 4 blocks, which contained the traditional convolutional layer, rectified linear unit(non-linear activation function), average pooling layer, and the softmax loss. They train the model with SGD and use changed learning rate, normalization, and data augmentation to improve the accuracy. The results show that the classification accuracy obtained with convolutional neural networks is higher than the average results obtained with the classical classification methods.


_“Classification of 41 Hand and Wrist Movements via Surface Electromyogram Using Deep Neural Network”[5]_

This paper implemented DNN on NinaPro-DB5/DB7 and achieved accuracy of 93.87±1.49 %. The stride between each window was set to be smaller than the window size so as to gain better performance. The noise threshold T was set to 0.01V for DB5. The architecture of Deep Neural Network Classifier was 3 hidden layers followed by ReLU and then softmax, which included Adam optimizer, with a learning rate of 0.005 and decay of 0.00001. The authors adopted batch normalization and 20 % dropout and used a trick called Evaluation metrics in the end. Due to half rest classes in the datasets, the accuracy needed to be balanced. For multi-class classification, taking the average of recall values can be generalized as the macro recall.


_“sEMG-Based Gesture Recognition with Convolutional Neural Networks”[6]_

This paper implemented a parallel multiple-scale CNN on NinaPro-DB2 and achieved accuracy better than a single CNN. The sEMG signals from 12 electrodes were converted into the sEMG images of size 12×200 (100ms, 2000 Hz). It selected some appropriate features representing for sEMG which can reduce the input dimension of the classifier. The architecture of the CNN is special, which was composed of two blocks. In Block 1, five convolution layers and two maximum pooling layers were employed. On the other hand, Block 2 was different in the first three convolution layers which adopted the bigger filter kernel size. The pooling layers were not adopted in Block 2. Those two blocks were parallel and did not influence one another when extracting features. The outputs of the two blocks are concatenated and then delivered to the classifier. The results show that a larger kernel filter can cause a slight increase in classification accuracy. Moreover, the combination of different sizes of kernel filters in the parallel blocks can yield better performance than single size. 


_“A multi-stream convolutional neural network for sEMG-based gesture recognition in muscle-computer interface”[7]_

This paper constructed a multi-stream convolutional neural network to train the NinaPro dataset and achieved an accuracy of 85.0%. The authors used the divide-and-conquer classification approach on feature-space, which considered sEMG signals in each channel independently and trained them using the same CNN architecture. In the divide stage: the convolutional neural network was constructed by two convolutional layers (3*3 kernel size) and two locally-connected layers (64 non-overlapping 2D filters) along with batch normalization, Relu, and dropout. The network was trained with SGD and tested with cross-validation. In the conquer stage: all feature maps learned from each CNN were fused into a unified feature map and sent into fusion networks. Relu followed by batch normalization were applied after each fully connected layer. The results show that considering sEMG signals recorded by each channel independently is better than considering sEMG signals recorded by all channels as a whole.

**References**

[1] Tankisi, H., Burke, D., Cui, L., de Carvalho, M., Kuwabara, S., Nandedkar, S. D., Rutkove, S., Stålberg, E., van Putten, M., & Fuglsang-Frederiksen, A. (2020). Standards of instrumentation of EMG. Clinical neurophysiology : official journal of the International Federation of Clinical Neurophysiology, 131(1), 243–258. https://doi.org/10.1016/j.clinph.2019.07.025

[2] R. Shioji, S. Ito, M. Ito and M. Fukumi, "Personal Authentication and Hand Motion Recognition based on Wrist EMG Analysis by a Convolutional Neural Network," 2018 IEEE International Conference on Internet of Things and Intelligence System (IOTAIS), 2018, pp. 184-188, doi: 10.1109/IOTAIS.2018.8600826.

[3] Buongiorno, D., Cascarano, G. D., De Feudis, I., Brunetti, A., Carnimeo, L., Dimauro, G., & Bevilacqua, V. (2021). Deep learning for processing electromyographic signals: A taxonomy-based survey. Neurocomputing, 452, 549-565.

[4] Atzori, M., Cognolato, M., & Müller, H. (2016). Deep learning with convolutional neural networks applied to electromyography data: A resource for the classification of movements for prosthetic hands. Frontiers in neurorobotics, 10, 9.

[5] Sri-iesaranusorn, P., Chaiyaroj, A., Buekban, C., Dumnin, S., Pongthornseri, R., Thanawattano, C., & Surangsrirat, D. (2021). Classification of 41 Hand and Wrist Movements via Surface Electromyogram Using Deep Neural Network. Frontiers in Bioengineering and Biotechnology, 9, 394.

[6] Ding, Z.; Yang, C.; Tian, Z.; Yi, C.; Fu, Y.; Jiang, F. sEMG-Based Gesture Recognition with Convolution Neural Networks. Sustainability 2018, 10, 1865.

[7] Wei, W., Wong, Y., Du, Y., Hu, Y., Kankanhalli, M., & Geng, W. (2019). A multi-stream convolutional neural network for sEMG-based gesture recognition in muscle-computer interface. Pattern Recognition Letters, 119, 131-138.

